var gallery={running:null,speed:'normal',timer:null,timer_interval:null,state:false,busy:false,images:[],container:null,thumbs:null,dimensions:{center:79.6,sides:9.7},ratio:{width:16,height:9},init:function(a,b){gallery.container=a;gallery.thumbs=$(b).find('img');var l=gallery.thumbs.length;for(i=0;x=l,i<x;i++){$(gallery.thumbs[i]).attr('id','img-'+(i+1))}$(gallery.container).append('<ul><li id="li0"></li></ul>');var i,x=gallery.thumbs,html='';for(i=1;i<x.length+1;i++){html="<li id='li"+i+"'><div></div></li>";$(gallery.container+' ul').append(html)}gallery.images=$(gallery.container+' ul').find('li');gallery.resize();$('#gallery img').click(function(e){gallery.open(parseInt(e.target.id.substring(4)))});$(window).resize(function(){gallery.resize()})},setDimensions:function(a,b){this.dimensions.center=a;this.dimensions.sides=b},setRatio:function(a,b){this.ratio.width=a;this.ratio.height=b;this.resize()},resize:function(){var a=parseFloat(((gallery.dimensions.center*$(window).width())/99).toFixed(2));var b=parseFloat(((a/this.ratio.width)*this.ratio.height).toFixed(2));var c=parseFloat((($(window).height()-b)/2).toFixed(2));$(gallery.container+' ul').animate({height:b,marginTop:c},gallery.speed)},load:function(c){var d=gallery.images,path='',order=[c,c-1,c+1,c-2,c+2],i=0;if(window.statusLoad==undefined)statusLoad=[];function rec(a){var b=gallery.thumbs[order[i]-1];if(i==order.length){return false}else if((statusLoad[order[i]]==true)||(b==undefined)){rec(++i);return false}var e=d[order[i]],path=gallery.getFullImageURL(b.src);statusLoad[order[i]]=true;$.get(path).done(function(){$(e).css("background","url("+path+") 0% 0% / cover");setTimeout(function(){$(e).find('div').fadeOut('normal');rec(++i)},200)}).fail(function(){statusLoad[order[i]]=false;rec(++i)})}rec(c)},jump:function(b){var c=1,times=Math.abs(gallery.running-b),storeSpeed=gallery.speed,tempSpeed=200,interval=0,command="";(b>gallery.running)?command=gallery.forth:command=gallery.back;gallery.speed=tempSpeed;function rec(a){if(a<=times){setTimeout(function(){command();rec(++a)},interval);interval=gallery.speed}else{gallery.speed=storeSpeed;return false}}rec(c)},open:function(a){if((a>gallery.images.length)||(a<1)||(a==undefined))return false;if(gallery.state==false){$(gallery.container).fadeIn('fast');gallery.state=true;if(a==gallery.running)return false}if(gallery.running===null){gallery.running=a;gallery.load(gallery.running);$('#li'+(gallery.running-1)).show(0,function(){$(this).animate({width:gallery.dimensions.sides+'%'},gallery.speed)});$('#li'+gallery.running).show(0,function(){$(this).animate({width:gallery.dimensions.center+'%'},gallery.speed)});$('#li'+(gallery.running+1)).show(0,function(){$(this).animate({width:gallery.dimensions.sides+'%'},gallery.speed)});return false}if((a>=gallery.running-2)&&(a<=gallery.running+2)){gallery.jump(a);return false}var b=gallery.running;gallery.running=a;gallery.load(gallery.running);$('#li'+(b+1)).animate({width:'0%'},gallery.speed,function(){$(this).hide()});$('#li'+(b)).animate({width:'0%'},gallery.speed,function(){$(this).hide()});$('#li'+(b-1)).animate({width:'0%'},gallery.speed,function(){$(this).hide()});$('#li'+(gallery.running+1)).show(0,function(){$(this).animate({width:gallery.dimensions.sides+'%'},gallery.speed)});$('#li'+(gallery.running)).show(0,function(){$(this).animate({width:gallery.dimensions.center+'%'},gallery.speed)});$('#li'+(gallery.running-1)).show(0,function(){$(this).animate({width:gallery.dimensions.sides+'%'},gallery.speed)})},close:function(){if(gallery.state==true){gallery.stop();$(gallery.container).fadeOut('fast');gallery.state=false}},forth:function(){if((gallery.busy==true)||(gallery.running==gallery.images.length-1)||(gallery.state==false))return false;gallery.running++;gallery.load(gallery.running);gallery.busy=true;setTimeout(function(){gallery.busy=false},(isNaN(gallery.speed))?jQuery.speed(gallery.speed).duration:gallery.speed);$('#li'+(gallery.running-2)).animate({width:'0%'},gallery.speed,function(){$(this).hide(0)});$('#li'+(gallery.running-1)).show(0,function(){$(this).animate({width:gallery.dimensions.sides+'%'},gallery.speed)});$('#li'+gallery.running).show(0,function(){$(this).animate({width:gallery.dimensions.center+'%'},gallery.speed)});$('#li'+(gallery.running+1)).show(0,function(){$(this).animate({width:gallery.dimensions.sides+'%'},gallery.speed)})},back:function(){if((gallery.busy==true)||(gallery.running==1)||(gallery.state==false))return false;gallery.running--;gallery.load(gallery.running);gallery.busy=true;setTimeout(function(){gallery.busy=false},(isNaN(gallery.speed))?jQuery.speed(gallery.speed).duration:gallery.speed);$('#li'+(gallery.running+2)).animate({width:'0%'},gallery.speed,function(){$(this).hide(0)});$('#li'+(gallery.running+1)).show(0,function(){$(this).animate({width:gallery.dimensions.sides+'%'},gallery.speed)});$('#li'+gallery.running).show(0,function(){$(this).animate({width:gallery.dimensions.center+'%'},gallery.speed)});$('#li'+(gallery.running-1)).show(0,function(){$(this).animate({width:gallery.dimensions.sides+'%'},gallery.speed)})},auto:function(a){if(a==undefined)a=3000;if((gallery.running==null)||($(gallery.container).css('display')=='none'))gallery.open(1);gallery.timer_interval=a;var b=gallery.images.length-1;if(gallery.running==b){gallery.timer=setInterval(function(){if(gallery.running==1){gallery.stop();gallery.auto(a);return false}gallery.back()},gallery.timer_interval)}else if(gallery.running==1){gallery.timer=setInterval(function(){if(gallery.running==b){gallery.stop();gallery.auto(a);return false}gallery.forth()},gallery.timer_interval)}else{gallery.timer=setInterval(function(){if(gallery.running==b){gallery.stop();gallery.auto(a);return false}gallery.forth()},gallery.timer_interval)}},stop:function(){clearInterval(gallery.timer)},maximize:function(){var a=gallery.images[gallery.running].src;window.open(a,'_blank')},getFullImageURL:function(a){return a.replace('thumbs/','')},log:function(){var x=gallery.running;console.log('busy, '+gallery.busy);console.log("running, "+x);console.log("li"+(x-2)+", display: "+$('#li'+(x-2)).css('display')+", width: "+$('#li'+(x-2)).css('width'));console.log("li"+(x-1)+", display: "+$('#li'+(x-1)).css('display')+", width: "+$('#li'+(x-1)).css('width'));console.log("li"+x+", display: "+$('#li'+x).css('display')+", width: "+$('#li'+x).css('width'));console.log("li"+(x+1)+", display: "+$('#li'+(x+1)).css('display')+", width: "+$('#li'+(x+1)).css('width'));console.log("li"+(x+2)+", display: "+$('#li'+(x+2)).css('display')+", width: "+$('#li'+(x+2)).css('width'));console.log("li"+(x+3)+", display: "+$('#li'+(x+3)).css('display')+", width: "+$('#li'+(x+3)).css('width'))}}